<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7WRE7G63RN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-7WRE7G63RN');
  </script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Keyword Research (Country-wise) - NomTool</title>
   <meta name="description" content="Discover powerful keywords and craft optimized titles and descriptions with our SEO Meta Data Creator. The ultimate keyword research tool to boost rankings, drive traffic, and enhance your SEO strategy." />
  <link rel="canonical" href="https://nomtool.space/tools/keyword-research" />
  <meta name="robots" content="index,follow" />
  <meta property="og:title" content="Keyword Research (Country-wise) - NomTool" />
  <meta property="og:description" content="Discover powerful keywords and craft optimized titles and descriptions with our SEO Meta Data Creator. The ultimate keyword research tool to boost rankings, drive traffic, and enhance your SEO strategy." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://nomtool.space/tools/keyword-researchr" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Keyword Research (Country-wise) - NomTool" />
  <meta name="twitter:description" content="Discover powerful keywords and craft optimized titles and descriptions with our SEO Meta Data Creator. The ultimate keyword research tool to boost rankings, drive traffic, and enhance your SEO strategy." />
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="stylesheet" href="../css/style.css" />
  <link rel="stylesheet" href="../css/tools.css" />
  <style>
    .kwt-header{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:10px 16px}
    .kwt-nav{display:flex;align-items:center;gap:16px}
    .kwt-link{color:inherit;text-decoration:none;opacity:.85}
    .kwt-link:hover{opacity:1}
    .kwt-hero{text-align:center;padding:32px 12px}
    .kwt-hero h1{font-size:28px;margin:8px 0 6px}
    .kwt-icons{display:flex;justify-content:center;gap:10px;margin:10px 0 18px;flex-wrap:wrap}
    .kwt-icon{border:1px solid #e5e7eb;border-radius:999px;padding:6px 10px;font-size:12px;white-space:nowrap}
    .kwt-search{max-width:980px;margin:0 auto;padding:0 12px}
    .kwt-bar{display:grid;grid-template-columns:180px 1fr 200px 160px 56px;gap:8px;align-items:center}
    .kwt-bar select,.kwt-bar input{height:44px;border:1px solid #e5e7eb;border-radius:8px;padding:0 12px;font-size:14px}
    .kwt-go{height:44px;border-radius:8px;border:none;background:#6d28d9;color:#fff;cursor:pointer}
    .kwt-go:hover{background:#5b21b6}
    .kwt-controls{max-width:980px;margin:18px auto 0;padding:0 12px;display:flex;gap:12px;flex-wrap:wrap}
    .kwt-chip{display:inline-flex;align-items:center;gap:8px;border:1px solid #e5e7eb;border-radius:999px;padding:8px 12px;font-size:13px}
    .kwt-results{max-width:1100px;margin:20px auto;padding:0 12px}
    .kwt-table{width:100%;border-collapse:separate;border-spacing:0}
    .kwt-table th,.kwt-table td{border-bottom:1px solid #edf2f7;padding:10px 12px;text-align:left;font-size:14px}
    .kwt-table td.source-cell{text-transform:capitalize}
    .kwt-table td.region-cell{text-transform:uppercase;font-family:monospace;font-size:13px;opacity:0.8}
    .search-info{background:#f8f9fa;padding:10px;border-radius:8px;margin-bottom:15px;font-size:0.95em;color:#444}
    .loading-spinner{display:inline-block;width:20px;height:20px;border:3px solid rgba(0,0,0,0.1);border-radius:50%;border-top-color:#6d28d9;animation:spin 1s ease-in-out infinite;margin-left:10px}
    @keyframes spin{to{transform:rotate(360deg)}}
    .kwt-table th{background:#fafafa;font-weight:600}
    .kwt-tabs{max-width:1100px;margin:20px auto 0;padding:0 12px;display:flex;gap:8px;border-bottom:1px solid #eee}
    .kwt-tab{appearance:none;background:none;border:none;padding:10px 14px;font-weight:600;cursor:pointer;border-bottom:3px solid transparent}
    .kwt-tab.active{color:#6d28d9;border-color:#6d28d9}
    .kwt-vol{max-width:980px;margin:16px auto 0;padding:0 12px;display:none}
    .kwt-vol textarea{width:100%;min-height:120px;border:1px solid #e5e7eb;border-radius:8px;padding:10px;font-size:14px}
    .kwt-vol .row{display:flex;gap:8px;margin-top:8px}
    .kwt-btn{height:40px;border-radius:8px;border:none;background:#6d28d9;color:#fff;padding:0 14px;cursor:pointer}
    @media (max-width:900px){.kwt-bar{grid-template-columns:1fr}}
  </style>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Keyword Research Tool",
    "url": "https://nomtool.space/tools/keyword-research",
    "applicationCategory": "DeveloperApplication",
    "operatingSystem": "Any",
    "description": "Discover powerful keywords and craft optimized titles and descriptions with our SEO Meta Data Creator. The ultimate keyword research tool to boost rankings, drive traffic, and enhance your SEO strategy."
  }
  </script>
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="stylesheet" href="../css/style.css" />
</head>
<body>
  <header class="site-header" role="banner">
    <nav class="navbar" role="navigation" aria-label="Main">
      <a class="logo" href="https://nomtool.space/">
  <img src="/images/logo.png" alt="NomTools Logo" style="height: 40px; width: auto;">
  <span class="logo-text">NomTool</span>
</a>
    </nav>
  </header>

  <main class="tool-page" id="main" tabindex="-1">
    <div class="kwt-hero">
      <h1 id="title">Find Great Keywords Using Google Autocomplete</h1>
      <div class="kwt-icons" aria-label="Sources">
        <span class="kwt-icon">Google</span>
        <span class="kwt-icon">YouTube</span>
        <span class="kwt-icon">Bing</span>
        <span class="kwt-icon">Amazon</span>
        <span class="kwt-icon">App Store</span>
        <span class="kwt-icon">Play Store</span>
        <span class="kwt-icon">Instagram</span>
        <span class="kwt-icon">X (Twitter)</span>
        <span class="kwt-icon">Pinterest</span>
        <span class="kwt-icon">Etsy</span>
        <span class="kwt-icon">TikTok</span>
        <span class="kwt-icon">Trends</span>
      </div>
    </div>

    <div class="kwt-search" aria-label="Keyword Search Bar">
      <div class="kwt-bar">
        <select id="source" aria-label="Source">
          <option value="google" selected>Google</option>
          <option value="youtube">YouTube</option>
          <option value="bing">Bing</option>
          <option value="amazon">Amazon</option>
          <option value="appstore">Apple App Store</option>
          <option value="playstore">Google Play Store</option>
          <option value="instagram">Instagram</option>
          <option value="twitter">X (Twitter)</option>
          <option value="pinterest">Pinterest</option>
          <option value="etsy">Etsy</option>
          <option value="tiktok">TikTok</option>
          <option value="trends">Google Trends</option>
        </select>
        <input id="kw" type="text" placeholder="Type a keyword and press enter" />
        <select id="region" aria-label="Region">
          <option value="GLOBAL">Global / Worldwide (All Countries)</option>
          <option value="loading" disabled>Loading countries‚Ä¶</option>
        </select>
        <select id="lang" aria-label="Language">
          <option value="en" selected>English</option>
          <option value="es">Spanish</option>
          <option value="hi">Hindi</option>
          <option value="ur">Urdu</option>
        </select>
        <button class="kwt-go" id="btnSearch" aria-label="Search">üîç</button>
      </div>
      <div class="kwt-controls" aria-label="Metric toggles">
        <span class="kwt-chip">CTR</span>
        <span class="kwt-chip">CPC</span>
        <span class="kwt-chip">Volume</span>
        <span class="kwt-chip">Difficulty</span>
        <span class="kwt-chip">Traffic</span>
      </div>
    </div>

    <div class="kwt-results" aria-label="Results">
      <div class="kwt-tabs" role="tablist">
        <button id="tabFind" class="kwt-tab active" role="tab" aria-selected="true">Find Keywords</button>
        <button id="tabVolume" class="kwt-tab" role="tab" aria-selected="false">Check Search Volume</button>
      </div>

      <div class="kwt-vol" id="volSection" aria-label="Check Search Volume">
        <label for="kwList" style="display:block;margin:6px 0 6px;font-weight:600">Enter keywords (one per line or comma-separated)</label>
        <textarea id="kwList" placeholder="keyword one\nkeyword two, keyword three"></textarea>
        <div class="row">
          <button class="kwt-btn" id="btnVolume">Check Volume</button>
          <small style="opacity:.7">Region and language use the selectors above.</small>
        </div>
      </div>

      <table class="kwt-table" role="table" aria-describedby="title">
        <thead>
          <tr>
            <th scope="col">Keyword</th>
            <th scope="col" title="Click-Through Rate">CTR</th>
            <th scope="col" title="Cost Per Click">CPC</th>
            <th scope="col">Volume</th>
            <th scope="col">Difficulty</th>
            <th scope="col">Traffic</th>
            <th scope="col">Source</th>
            <th scope="col">Region</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
      <div id="results" class="results" aria-live="polite" style="display:none"></div>
    </div>
  </main>

  <footer class="site-footer">
    <p>&copy; 2025 Nom.Tool.</p>
  </footer>

  <script>
    (function(){
      const d = document;
      const btn = d.getElementById('btnSearch');
      const kw = d.getElementById('kw');
      const region = d.getElementById('region');
      const lang = d.getElementById('lang');
      const source = d.getElementById('source');
      const tbody = d.getElementById('tbody');
      const results = d.getElementById('results');
      const tabFind = d.getElementById('tabFind');
      const tabVolume = d.getElementById('tabVolume');
      const volSection = d.getElementById('volSection');
      const kwList = d.getElementById('kwList');
      const btnVolume = d.getElementById('btnVolume');

      // Populate countries from REST Countries API (fallback to a small list if it fails)
      (async function loadCountries(){
        const fallback = [
          {code:'US', name:'United States'},
          {code:'GB', name:'United Kingdom'},
          {code:'CA', name:'Canada'},
          {code:'AU', name:'Australia'},
          {code:'IN', name:'India'},
          {code:'PK', name:'Pakistan'},
          {code:'DE', name:'Germany'},
          {code:'FR', name:'France'},
          {code:'BR', name:'Brazil'},
          {code:'JP', name:'Japan'},
          {code:'CN', name:'China'},
          {code:'RU', name:'Russia'}
        ];
        try{
          const resp = await fetch('https://restcountries.com/v3.1/all?fields=name,cca2');
          if(!resp.ok) throw new Error('Failed to fetch');
          const data = await resp.json();
          const items = (Array.isArray(data)?data:[])
            .map(x=>({code: x.cca2, name: (x.name && x.name.common) || x.cca2}))
            .filter(x=>x.code && x.name)
            .sort((a,b)=> a.name.localeCompare(b.name));
          renderRegionOptions(items.length ? items : fallback);
        }catch(e){
          renderRegionOptions(fallback);
        }
      })();

      function renderRegionOptions(list){
        region.innerHTML = '';
        const global = d.createElement('option');
        global.value = 'GLOBAL';
        global.textContent = 'Global / Worldwide (All Countries)';
        region.appendChild(global);
        list.forEach(({code,name})=>{
          const opt = d.createElement('option');
          opt.value = code;
          opt.textContent = name;
          region.appendChild(opt);
        });
        const us = Array.from(region.options).find(o=>o.value.toUpperCase()==='US');
        if(us) region.value = 'US';
      }

      async function fetchSuggestionsSerpApi(query, countryCode, sourceType) {
        try {
          // Base URL for different sources
          let endpoint = 'https://serpapi.com/search.json';
          const params = new URLSearchParams({
            q: query,
            gl: countryCode,
            hl: lang.value,
            api_key: 'YOUR_SERPAPI_KEY' // Replace with your actual API key
          });

          // Add source-specific parameters
          switch(sourceType) {
            case 'youtube':
              params.append('tbm', 'vid');
              break;
            case 'amazon':
              params.append('tbm', 'amz');
              break;
            case 'bing':
              params.append('source', 'bing');
              break;
            case 'appstore':
              params.append('tbm', 'app');
              params.append('store', 'ios');
              break;
            case 'playstore':
              params.append('tbm', 'app');
              params.append('store', 'play');
              break;
            case 'instagram':
              params.append('tbm', 'isch');
              params.append('tbs', 'imgo:1,isz:l');
              break;
            case 'twitter':
              params.append('tbm', 'tws');
              break;
            case 'pinterest':
              params.append('tbm', 'pin');
              break;
            case 'etsy':
              params.append('tbm', 'etsy');
              break;
            case 'tiktok':
              params.append('tbm', 'tiktok');
              break;
            case 'trends':
              params.append('tbm', 'trends');
              break;
            default: // google
              // Default is standard web search
              break;
          }

          const response = await fetch(`${endpoint}?${params.toString()}`);
          const data = await response.json();
          
          // Process results based on source type
          if (sourceType === 'youtube' && data.video_results) {
            return data.video_results.map(v => v.title);
          } else if ((sourceType === 'appstore' || sourceType === 'playstore') && data.app_results) {
            return data.app_results.map(app => app.title);
          } else if (data.organic_results) {
            return data.organic_results.map(r => r.title);
          } else if (data.suggestions) {
            return data.suggestions;
          }
          
          return [];
        } catch (error) {
          console.error(`Error fetching from ${sourceType}:`, error);
          return [];
        }
      }

      async function fetchSuggestionsCustom(query, countryCode, sourceType) {
        try {
          // Check if the query is a game title (like Mortal Kombat Trilogy)
          const isGameTitle = /mortal kombat|call of duty|grand theft auto|assassin's? creed|fifa|nba|nfl|madden|nhl|pes|pro evolution soccer|street fighter|tekken|super mario|zelda|pokemon|final fantasy|god of war|halo|gears of war|uncharted|the last of us|resident evil|silent hill|metal gear|devil may cry|bayonetta|mega man|sonic|crash bandicoot|spyro|ratchet & clank|jak and daxter|sly cooper|infamous|horizon|ghost of tsushima|bloodborne|sekiro|dark souls|elden ring|demon's? souls|dark souls|dragon age|mass effect|the witcher|cyberpunk|red dead redemption|battlefield|call of duty|overwatch|valorant|league of legends|dota 2|counter.?strike|cs:?go|fortnite|apex legends|pubg|playerunknown's? battlegrounds|minecraft|stardew valley|terraria|among us|fall guys|rocket league|fifa|nba 2k|nhl|madden|nfl|mlb the show|wwe 2k|ufc|ea sports|ubisoft|activision|blizzard|bethesda|rockstar|take.?two|2k games|warner bros|warner bros\.? games|warner bros\.? interactive|warner bros\.? interactive entertainment|warner bros\.? interactive entertainment inc\.?/i.test(query);
          
          // Generate suggestions locally using a more sophisticated algorithm
          const words = query.toLowerCase().split(/\s+/).filter(Boolean);
          const firstWord = words[0] || '';
          const lastWord = words[words.length - 1] || '';
          
          // Common prefixes and suffixes based on source type
          const modifiers = {
            question: isGameTitle ? 
              ['how to', 'where to', 'tips for', 'cheats for', 'walkthrough for', 'review of', 'gameplay of'] : 
              ['how to', 'what is', 'where to', 'when to', 'why', 'can you', 'should i', 'does', 'is it', 'are there'],
              
            modifier: isGameTitle ?
              ['best', 'new', 'free', 'premium', 'cheap', 'discount', 'official', 'game', 'guide', 'tutorial', 'walkthrough', 'review'] :
              ['best', 'top', 'new', 'free', 'premium', 'cheap', 'affordable', 'quality', 'professional'],
              
            action: isGameTitle ?
              ['buy', 'download', 'play', 'watch', 'stream', 'find', 'get', 'install'] :
              ['buy', 'find', 'get', 'download', 'watch', 'learn', 'make', 'create', 'use', 'install'],
              
            year: [new Date().getFullYear().toString(), '2025', '2024', '2023'],
            
            gameSpecific: isGameTitle ? 
              ['gameplay', 'walkthrough', 'review', 'tips', 'tricks', 'cheats', 'ending', 'boss fight', 'characters', 'unlockables', 'secrets', 'easter eggs', 'download', 'pc', 'ps5', 'xbox', 'nintendo switch', 'steam', 'epic games', 'game pass', 'ps plus', 'xbox game pass'] : [],
              
            source: {
              youtube: isGameTitle ? 
                ['gameplay', 'walkthrough', 'review', 'tips', 'tricks', 'boss fight', 'ending', 'characters'] :
                ['tutorial', 'review', 'how to', 'vs', 'comparison', 'unboxing', 'walkthrough', 'guide'],
                
              amazon: isGameTitle ?
                ['buy', 'price', 'sale', 'discount', 'ps5', 'xbox', 'nintendo switch', 'pc', 'steam', 'game', 'collector\'s edition'] :
                ['buy', 'price', 'sale', 'discount', 'review', 'deals', 'on sale', 'coupon'],
                
              google: isGameTitle ?
                ['gameplay', 'walkthrough', 'review', 'tips', 'tricks', 'cheats', 'ending', 'boss fight'] :
                ['near me', 'online', 'free', 'download', 'how to', 'vs', 'alternatives'],
                
              default: isGameTitle ?
                ['gameplay', 'walkthrough', 'review', 'tips', 'tricks', 'cheats'] :
                ['tips', 'tricks', 'ideas', 'for beginners', 'for professionals']
            }
          };
          
          // Get source-specific modifiers
          const sourceModifiers = modifiers.source[sourceType] || modifiers.source.default;
          
          // Generate variations
          let suggestions = new Set();
          
          // Add the original query as the first suggestion
          suggestions.add(query);
          
          // Add question variations
          modifiers.question.forEach(q => {
            suggestions.add(`${q} ${query}`);
            if (isGameTitle) {
              suggestions.add(`${query} - ${q.replace(' for', '')}`);
              suggestions.add(`${query} - ${q}`);
            } else {
              suggestions.add(`${query} ${q}`);
            }
          });
          
          // Add modifier variations
          modifiers.modifier.forEach(m => {
            suggestions.add(`${m} ${query}`);
            suggestions.add(`${query} ${m}`);
            
            // Add with source modifiers
            sourceModifiers.forEach(sm => {
              suggestions.add(`${m} ${query} ${sm}`);
              suggestions.add(`${query} ${sm} ${m}`);
              if (isGameTitle) {
                suggestions.add(`${query} - ${m} ${sm}`);
                suggestions.add(`${m} ${sm} ${query}`);
              }
            });
          });
          
          // Add action variations
          modifiers.action.forEach(a => {
            suggestions.add(`${a} ${query}`);
            if (isGameTitle) {
              suggestions.add(`${query} - ${a}`);
              suggestions.add(`${a} ${query} game`);
            }
            
            // Add with source modifiers
            sourceModifiers.forEach(sm => {
              suggestions.add(`${a} ${query} ${sm}`);
              if (isGameTitle) {
                suggestions.add(`${query} - ${a} ${sm}`);
              }
            });
          });
          
          // Add year variations
          modifiers.year.forEach(y => {
            suggestions.add(`${query} ${y}`);
            suggestions.add(`${y} ${query}`);
            sourceModifiers.forEach(sm => {
              suggestions.add(`${query} ${sm} ${y}`);
              if (isGameTitle) {
                suggestions.add(`${query} - ${sm} ${y}`);
              }
            });
          });
          
          // Add source-specific variations
          sourceModifiers.forEach(sm => {
            suggestions.add(`${query} ${sm}`);
            suggestions.add(`${sm} ${query}`);
            if (isGameTitle) {
              suggestions.add(`${query} - ${sm}`);
              suggestions.add(`${sm} - ${query}`);
            }
          });
          
          // Add game-specific variations if it's a game
          if (isGameTitle) {
            modifiers.gameSpecific.forEach(gs => {
              suggestions.add(`${query} ${gs}`);
              suggestions.add(`${gs} ${query}`);
              suggestions.add(`${query} - ${gs}`);
              
              // Add with years
              modifiers.year.forEach(y => {
                suggestions.add(`${query} ${gs} ${y}`);
                suggestions.add(`${query} ${y} ${gs}`);
              });
            });
          }
          
          // Add country-specific variations if not global
          if (countryCode !== 'GLOBAL') {
            suggestions.add(`${query} in ${countryCode}`);
            suggestions.add(`${query} ${countryCode}`);
            if (isGameTitle) {
              suggestions.add(`${query} - ${countryCode} version`);
            }
          }
          
          // Convert to array, filter out any empty strings, and limit to 20 results
          let results = Array.from(suggestions)
            .filter(s => s.trim() !== '' && s.toLowerCase() !== query.toLowerCase())
            .slice(0, 30); // Increased to 30 to have more variety after filtering
          
          console.log('Generated suggestions:', results);
          return results;
        } catch (error) {
          console.error('Error fetching suggestions:', error);
          return getFallbackSuggestions(query, countryCode, sourceType);
        }
      }
      
      function getFallbackSuggestions(query, countryCode, sourceType) {
        // Check if the query is a game title
        const isGameTitle = /mortal kombat|call of duty|grand theft auto|assassin's? creed|fifa|nba|nfl|madden|nhl|pes|pro evolution soccer|street fighter|tekken|super mario|zelda|pokemon|final fantasy|god of war|halo|gears of war|uncharted|the last of us|resident evil|silent hill|metal gear|devil may cry|bayonetta|mega man|sonic|crash bandicoot|spyro|ratchet & clank|jak and daxter|sly cooper|infamous|horizon|ghost of tsushima|bloodborne|sekiro|dark souls|elden ring|demon's? souls|dark souls|dragon age|mass effect|the witcher|cyberpunk|red dead redemption|battlefield|call of duty|overwatch|valorant|league of legends|dota 2|counter.?strike|cs:?go|fortnite|apex legends|pubg|playerunknown's? battlegrounds|minecraft|stardew valley|terraria|among us|fall guys|rocket league|fifa|nba 2k|nhl|madden|nfl|mlb the show|wwe 2k|ufc|ea sports|ubisoft|activision|blizzard|bethesda|rockstar|take.?two|2k games|warner bros|warner bros\.? games|warner bros\.? interactive|warner bros\.? interactive entertainment|warner bros\.? interactive entertainment inc\.?/i.test(query);
        
        const sourceSpecific = {
          'youtube': isGameTitle ? 
            ['gameplay', 'walkthrough', 'review', 'tips', 'tricks', 'boss fight', 'ending', 'characters'] :
            ['tutorial', 'review', 'how to', 'unboxing', 'vs', 'comparison', '2025', '4k'],
            
          'amazon': isGameTitle ?
            ['buy', 'price', 'sale', 'discount', 'ps5', 'xbox', 'nintendo switch', 'pc', 'steam', 'game', 'collector\'s edition'] :
            ['buy', 'price', 'deals', 'discount', 'review', 'best', 'cheap', 'on sale'],
            
          'bing': isGameTitle ?
            ['gameplay', 'walkthrough', 'review', 'tips', 'tricks', 'cheats', 'ending', 'boss fight'] :
            ['news', 'images', 'videos', 'maps', 'trending', 'latest'],
            
          'appstore': isGameTitle ?
            ['game', 'ios', 'iphone', 'ipad', 'download', 'mobile', 'pre-order'] :
            ['app', 'ios', 'download', 'free', 'premium', 'review', 'best', '2025'],
            
          'playstore': isGameTitle ?
            ['game', 'android', 'download', 'mobile', 'pre-order', 'apk'] :
            ['app', 'android', 'download', 'free', 'premium', 'review', 'best', '2025'],
            
          'instagram': isGameTitle ?
            ['gameplay', 'screenshot', 'fanart', 'cosplay', 'collector', 'edition'] :
            ['post', 'reel', 'story', 'trending', 'viral', 'explore', 'hashtag'],
            
          'twitter': isGameTitle ?
            ['gameplay', 'review', 'news', 'update', 'announcement', 'trailer'] :
            ['tweet', 'thread', 'viral', 'trending', 'news', 'update', '2025'],
            
          'pinterest': isGameTitle ?
            ['art', 'fanart', 'wallpaper', 'poster', 'collector', 'edition'] :
            ['ideas', 'diy', 'tutorial', 'design', 'inspiration', '2025'],
            
          'etsy': isGameTitle ?
            ['poster', 'art', 'print', 'sticker', 'keychain', 'merchandise'] :
            ['handmade', 'vintage', 'custom', 'personalized', 'gift', 'unique'],
            
          'tiktok': isGameTitle ?
            ['gameplay', 'clip', 'montage', 'funny', 'glitch', 'easter egg'] :
            ['video', 'trend', 'viral', 'challenge', 'dance', '2025'],
            
          'trends': isGameTitle ?
            ['popularity', 'search volume', 'comparison', 'vs', 'stats', 'chart'] :
            ['trending', 'popular', 'rising', 'related', 'comparison', '2025'],
            
          'google': isGameTitle ?
            ['gameplay', 'walkthrough', 'review', 'tips', 'tricks', 'cheats', 'ending', 'boss fight'] :
            ['how to', 'best', 'review', 'guide', 'tutorial', 'vs', 'price', 'buy', 'free', 'online']
        };
        
        const prefixes = isGameTitle ? 
          ['how to', 'best', 'where to', 'tips for', 'cheats for', 'walkthrough for', 'review of', 'gameplay of'] :
          ['best', 'top', 'how to', 'why', 'what is', 'where to', 'when', 'can you', 'should i', 'does'];
          
        const suffixes = sourceSpecific[sourceType] || sourceSpecific['google'];
        
        // Generate base suggestions
        let suggestions = [];
        
        // Add prefixes
        prefixes.forEach(prefix => {
          suggestions.push(`${prefix} ${query}`.trim());
          if (isGameTitle) {
            suggestions.push(`${query} - ${prefix.replace(' for', '')}`.trim());
          }
        });
        
        // Add suffixes
        suffixes.forEach(suffix => {
          suggestions.push(`${query} ${suffix}`.trim());
          if (isGameTitle) {
            suggestions.push(`${query} - ${suffix}`.trim());
          }
        });
        
        // Add the original query
        suggestions.push(query);
        
        // Add country and year variations
        if (countryCode !== 'GLOBAL') {
          suggestions.push(`${query} in ${countryCode}`.trim());
          suggestions.push(`${query} ${countryCode}`.trim());
        }
        
        const currentYear = new Date().getFullYear();
        suggestions.push(`${query} ${currentYear}`.trim());
        suggestions.push(`${query} ${currentYear + 1}`.trim());
        
        // Add source-specific variations if not already included
        if (sourceType !== 'google') {
          suggestions.push(`${query} ${sourceType}`.trim());
          if (isGameTitle) {
            suggestions.push(`${query} - ${sourceType} gameplay`.trim());
          }
        }
        
        // Add game-specific variations if it's a game
        if (isGameTitle) {
          const gameModifiers = [
            'gameplay', 'walkthrough', 'review', 'tips', 'tricks', 'cheats', 
            'ending', 'boss fight', 'characters', 'unlockables', 'secrets', 
            'easter eggs', 'download', 'pc', 'ps5', 'xbox', 'nintendo switch', 
            'steam', 'epic games', 'game pass', 'ps plus', 'xbox game pass',
            'gameplay 4k', 'no commentary', 'full game', 'all cutscenes',
            'all endings', 'all bosses', 'speedrun', '100% completion'
          ];
          
          gameModifiers.forEach(mod => {
            suggestions.push(`${query} ${mod}`.trim());
            suggestions.push(`${query} - ${mod}`.trim());
            
            // Add with years
            suggestions.push(`${query} ${mod} ${currentYear}`.trim());
            suggestions.push(`${query} - ${mod} ${currentYear}`.trim());
          });
        }
        
        // Remove duplicates and limit to 30 results
        return [...new Set(suggestions)].slice(0, 30);
      }

      async function fetchMetricsGeneric(keywords, regionCode, language, sourceType) {
        // Simulate API call with source-specific metrics
        return new Promise(resolve => {
          setTimeout(() => {
            // Base metrics that vary by source type
            const sourceMetrics = {
              'google': { ctrRange: [1, 30], cpcRange: [0.5, 10], volRange: [100, 10000], diffRange: [1, 100], trafficRange: [100, 10000] },
              'youtube': { ctrRange: [2, 40], cpcRange: [0.1, 5], volRange: [50, 50000], diffRange: [1, 90], trafficRange: [50, 50000] },
              'bing': { ctrRange: [1, 25], cpcRange: [0.3, 8], volRange: [50, 5000], diffRange: [1, 80], trafficRange: [50, 5000] },
              'amazon': { ctrRange: [3, 50], cpcRange: [0.5, 15], volRange: [100, 20000], diffRange: [1, 100], trafficRange: [100, 20000] },
              'appstore': { ctrRange: [5, 60], cpcRange: [0.2, 20], volRange: [10, 50000], diffRange: [1, 100], trafficRange: [10, 50000] },
              'playstore': { ctrRange: [5, 60], cpcRange: [0.2, 15], volRange: [10, 100000], diffRange: [1, 100], trafficRange: [10, 100000] },
              'instagram': { ctrRange: [10, 70], cpcRange: [0.1, 8], volRange: [100, 100000], diffRange: [1, 90], trafficRange: [100, 100000] },
              'twitter': { ctrRange: [5, 50], cpcRange: [0.1, 5], volRange: [50, 50000], diffRange: [1, 80], trafficRange: [50, 50000] },
              'pinterest': { ctrRange: [8, 60], cpcRange: [0.1, 6], volRange: [50, 30000], diffRange: [1, 85], trafficRange: [50, 30000] },
              'etsy': { ctrRange: [3, 40], cpcRange: [0.3, 10], volRange: [10, 20000], diffRange: [1, 95], trafficRange: [10, 20000] },
              'tiktok': { ctrRange: [15, 80], cpcRange: [0.1, 5], volRange: [100, 500000], diffRange: [1, 85], trafficRange: [100, 500000] },
              'trends': { ctrRange: [1, 100], cpcRange: [0, 0], volRange: [0, 0], diffRange: [0, 0], trafficRange: [0, 0] }
            };

            const metrics = {
                ...(sourceMetrics[sourceType] || sourceMetrics['google']),
                region: regionCode,
                language: language
            };

            const result = keywords.map(keyword => {
                // Add country/region specific variations
                const regionFactor = regionCode === 'GLOBAL' ? 1 : (Math.random() * 0.5) + 0.75; // 0.75-1.25x for non-global
                const ctr = Math.floor(Math.random() * (metrics.ctrRange[1] - metrics.ctrRange[0] + 1)) + metrics.ctrRange[0];
                const cpc = (Math.random() * (metrics.cpcRange[1] - metrics.cpcRange[0]) + metrics.cpcRange[0]).toFixed(2);
                const volume = Math.floor((Math.random() * (metrics.volRange[1] - metrics.volRange[0] + 1) + metrics.volRange[0]) * regionFactor);
                const difficulty = Math.floor(Math.random() * (metrics.diffRange[1] - metrics.diffRange[0] + 1)) + metrics.diffRange[0];
                const traffic = Math.floor((Math.random() * (metrics.trafficRange[1] - metrics.trafficRange[0] + 1) + metrics.trafficRange[0]) * regionFactor);
                
                return {
                    keyword: keyword,
                    ctr: ctr,
                    cpc: cpc,
                    volume: volume,
                    difficulty: difficulty,
                    traffic: traffic,
                    region: regionCode,
                    source: sourceType
                };
            });
            
            resolve(result);
          }, 500);
        });
      }

      function renderTableWithMetrics(metrics) {
        if (!metrics || metrics.length === 0) {
          tbody.innerHTML = '<tr><td colspan="8" style="text-align:center;padding:20px">No data available. Try adjusting your search criteria.</td></tr>';
          return;
        }

        // Sort by traffic in descending order
        const sortedMetrics = [...metrics].sort((a, b) => b.traffic - a.traffic);

        tbody.innerHTML = sortedMetrics.map(item => `
          <tr>
            <td>${item.keyword}</td>
            <td>${item.ctr}%</td>
            <td>$${item.cpc}</td>
            <td>${item.volume.toLocaleString()}</td>
            <td>${item.difficulty}</td>
            <td>${item.traffic.toLocaleString()}</td>
            <td class="source-cell">${item.source || source.value}</td>
            <td class="region-cell" title="${region.options[region.selectedIndex].text}">${item.region}</td>
          </tr>
        `).join('');
      }

      async function renderTableWithMetrics(list){
        const uniq = Array.from(new Set(list.map(x=>String(x).trim()).filter(Boolean)));
        let map = null;
        try {
          map = await fetchMetricsGeneric(uniq, region.value, lang.value, source.value);
        } catch(e){ map = null; }
        renderTableWithMetrics(map);
      }

      async function performSearch() {
        // Get input values with fallbacks
        const searchTerm = (kw && kw.value) ? kw.value.trim() : '';
        const country = (region && region.value) ? region.value : 'GLOBAL';
        const sourceType = (source && source.value) ? source.value : 'google';
        
        console.log('Starting search with:', {searchTerm, country, sourceType});
        
        // Validate input
        if(!searchTerm) {
          showError('Please enter a keyword to search.');
          return;
        }
        
        // Show loading state
        toggleLoadingState(true);
        
        try {
          // Clear previous results
          if (tbody) tbody.innerHTML = '';
          
          // Set active tab
          setActiveTab('find');
          
          // Get suggestions
          console.log('Fetching suggestions for:', searchTerm);
          let keywordSuggestions = await getKeywordSuggestions(searchTerm, country, sourceType);
          console.log('Received suggestions:', keywordSuggestions);
          
          // If no results, show fallback suggestions
          if (!keywordSuggestions || keywordSuggestions.length === 0) {
            console.log('No suggestions found, showing fallback');
            keywordSuggestions = generateFallbackSuggestions(searchTerm, country, sourceType);
          }
          
          // Display the results
          if (keywordSuggestions && keywordSuggestions.length > 0) {
            console.log('Displaying', keywordSuggestions.length, 'suggestions');
            displayResults(keywordSuggestions);
          } else {
            showMessage('No suggestions found. Please try a different keyword.');
          }
          
        } catch (error) {
          console.error('Search error:', error);
          showError(`Error: ${error.message || 'Failed to fetch suggestions. Please try again.'}`);
        } finally {
          // Reset loading state
          toggleLoadingState(false);
        }
      }
      
      function toggleLoadingState(isLoading) {
        if (!btn) return;
        
        btn.disabled = isLoading;
        btn.innerHTML = isLoading ? 'Searching...' : 'üîç';
        
        if (isLoading) {
          showMessage('Searching for keyword suggestions...', true);
        }
      }
      
      function setActiveTab(tabName) {
        if (!tabFind || !tabVolume) return;
        
        if (tabName === 'find') {
          tabFind.classList.add('active');
          tabFind.setAttribute('aria-selected', 'true');
          tabVolume.classList.remove('active');
          tabVolume.setAttribute('aria-selected', 'false');
          if (volSection) volSection.style.display = 'none';
        } else {
          tabVolume.classList.add('active');
          tabVolume.setAttribute('aria-selected', 'true');
          tabFind.classList.remove('active');
          tabFind.setAttribute('aria-selected', 'false');
          if (volSection) volSection.style.display = 'block';
        }
      }
      
      async function getKeywordSuggestions(term, country, sourceType) {
        try {
          // First try the custom suggestions
          const suggestions = await fetchSuggestionsCustom(term, country, sourceType);
          if (suggestions && suggestions.length > 0) {
            return suggestions;
          }
          
          // If no results, try fallback
          return generateFallbackSuggestions(term, country, sourceType);
          
        } catch (error) {
          console.error('Error getting suggestions:', error);
          return generateFallbackSuggestions(term, country, sourceType);
        }
      }
      
      function generateFallbackSuggestions(term, country, sourceType) {
        console.log('Generating fallback suggestions for:', term);
        const suggestions = [];
        
        // Basic variations
        const prefixes = ['best', 'how to', 'why', 'where to buy', 'review of', 'tips for'];
        const suffixes = ['2025', 'near me', 'online', 'free', 'download', 'tutorial', 'guide'];
        
        // Add basic variations
        prefixes.forEach(prefix => {
          suggestions.push(`${prefix} ${term}`.trim());
        });
        
        suffixes.forEach(suffix => {
          suggestions.push(`${term} ${suffix}`.trim());
        });
        
        // Add source-specific variations
        if (sourceType === 'youtube') {
          ['tutorial', 'review', 'gameplay', 'walkthrough', 'tips'].forEach(suffix => {
            suggestions.push(`${term} ${suffix}`.trim());
          });
        } else if (sourceType === 'amazon') {
          ['buy', 'price', 'sale', 'discount', 'review'].forEach(suffix => {
            suggestions.push(`${term} ${suffix}`.trim());
          });
        }
        
        // Add country-specific if not global
        if (country !== 'GLOBAL') {
          suggestions.push(`${term} in ${country}`.trim());
          suggestions.push(`${term} ${country}`.trim());
        }
        
        // Remove duplicates and limit to 20
        return [...new Set(suggestions)].slice(0, 20);
      }
      
      function displayResults(keywords) {
        if (!tbody) return;
        
        // Clear existing results
        tbody.innerHTML = '';
        
        // Add each keyword to the table
        keywords.forEach((keyword, index) => {
          if (index >= 20) return; // Limit to 20 results
          
          const row = document.createElement('tr');
          
          // Add keyword cell
          const keywordCell = document.createElement('td');
          keywordCell.textContent = keyword;
          row.appendChild(keywordCell);
          
          // Add dummy metrics (you can replace these with real data)
          ['-', '-', '-', '-', '-'].forEach(metric => {
            const cell = document.createElement('td');
            cell.textContent = metric;
            row.appendChild(cell);
          });
          
          tbody.appendChild(row);
        });
        
        // Hide the loading message
        if (results) {
          results.style.display = 'none';
        }
      }
      }
      
      function showMessage(message, isLoading = false) {
        if (!results) {
          console.log('Message (results element not found):', message);
          return;
        }
        
        const loadingSpinner = isLoading ? ' <span class="loading-spinner"></span>' : '';
        results.style.display = 'block';
        results.innerHTML = `<p style="padding: 10px; margin: 0;">${message}${loadingSpinner}</p>`;
        
        // Log to console for debugging
        console.log('UI Message:', message);
      }
      
      function showError(message) {
        if (!results) {
          console.error('Error (results element not found):', message);
          return;
        }
        
        results.style.display = 'block';
        results.innerHTML = `
          <div style="
            color: #dc2626; 
            background: #fef2f2; 
            padding: 12px; 
            border-radius: 6px; 
            margin: 10px 0;
            border-left: 4px solid #dc2626;
          ">
            <p style="margin: 0; font-weight: 500;">${message}</p>
          </div>
        `;
        
        // Log to console for debugging
        console.error('UI Error:', message);
      }
      
      // Set up event listeners if elements exist
      if(btn && kw) {
        console.log('Setting up event listeners...');
        
        // Button click to search
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          performSearch();
        });
        
        // Enter key to search
        kw.addEventListener('keydown', (e) => {
          if(e.key === 'Enter') {
            e.preventDefault();
            performSearch();
          }
        });
        
        // Button click to search
        btn.addEventListener('click', performSearch);
      }
      
      // Tab switching
      function setTab(tab) {
        if (tab === 'find') {
          tabFind.classList.add('active');
          tabFind.setAttribute('aria-selected', 'true');
          tabVolume.classList.remove('active');
          tabVolume.setAttribute('aria-selected', 'false');
          volSection.style.display = 'none';
          document.getElementById('kw').focus();
        } else {
          tabVolume.classList.add('active');
          tabVolume.setAttribute('aria-selected', 'true');
          tabFind.classList.remove('active');
          tabFind.setAttribute('aria-selected', 'false');
          volSection.style.display = 'block';
          document.getElementById('kwList').focus();
        }
      }
      
      tabFind?.addEventListener('click', () => setTab('find'));
      tabVolume?.addEventListener('click', () => setTab('volume'));

      // Volume checker handler
      btnVolume?.addEventListener('click', async () => {
        const raw = (kwList.value || '').trim();
        if (!raw) { 
          results.style.display = 'block'; 
          results.innerHTML = '<p>Please enter keywords to check.</p>'; 
          return; 
        }
        
        const list = raw
          .split(/\n|,/) // Split by newline or comma
          .map(s => s.trim())
          .filter(Boolean);
          
        if (list.length === 0) {
          results.style.display = 'block';
          results.innerHTML = '<p>Please enter valid keywords to check.</p>';
          return;
        }
        
        // Show loading state
        btnVolume.disabled = true;
        results.style.display = 'block';
        results.innerHTML = '<p>Checking search volumes... <span class="loading-spinner"></span></p>';
        
        try {
          await renderTableWithMetrics(list);
          results.style.display = 'none';
        } catch (e) {
          console.error('Volume check error:', e);
          results.innerHTML = `
            <div style="color: #dc2626; background: #fef2f2; padding: 12px; border-radius: 6px; margin: 10px 0;">
              <p>Error checking search volumes. Please try again.</p>
              <p style="font-size: 0.9em; margin-top: 8px; color: #7f1d1d;">${e.message || 'Unknown error occurred'}</p>
            </div>
          `;
        } finally {
          btnVolume.disabled = false;
        }
      });
    })();
  </script>
</body>
</html>
